<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>W3cValidator API v. 0.1</title>
</head>
<body>

<p>
This Class is a Curl-Xml wrapper to the W3C validator SOAP Webservice
</p>

<p>
<h1>Include Library</h1>
set_time_limit(3600);<br />

include("CurlObj.class.php");<br />
include("W3cValidator.class.php");<br />
$check = new W3cValidator();<br />
<hr />
</p>
<p>
<h1>validate Method</h1>
   <span class="type">array()</span> <span class="methodname"><b>validate</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter"><i>$url</i></tt></span>

   )</br>
<p>
Use a GET http request to the server, parse the returned <strong>XML</strong> and store it in an array
</p>
   <hr />
$url = 'http://www.governo.it/Presidenza/index.html';<br />
$result = $check-><strong>validate(</strong><i>$url</i><strong>)</strong>;<br />

var_dump($result);<br />

<pre><xmp>array(5) {
  ["status"]=>
  string(5) "valid"
  ["err_num"]=>
  int(0)
  ["errors"]=>
  array(0) {
  }
  ["warnings"]=>
  array(0) {
  }
  ["warn_num"]=>
  int(0)
}
</xmp></pre><hr />
$url = 'http://www.nasa.gov/';<br />
$result = $check-><strong>validate(</strong><i>$url</i><strong>)</strong>;<br />
var_dump($result);<br />

<pre><xmp>array(5) {
  ["status"]=>
  string(7) "invalid"
  ["err_num"]=>
  int(2)
  ["errors"]=>
  array(2) {
    [0]=>
    array(5) {
      ["line"]=>
      int(1)
      ["col"]=>
      int(11)
      ["message"]=>
      string(81) "delimiter """ invalid: only name, "#IMPLIED" and parameter separators are allowed"
      ["messageid"]=>
      string(2) "39"
      ["explanation"]=>
      string(227) "<p class="helpwanted">
      <a
        href="feedback.html?uri=http%3A%2F%2Fwww.nasa.gov%2F;errmsg_id=39#errormsg"
	title="Suggest improvements on this error message through our feedback channels" 
      >&#x2709;</a>
    </p>"
    }
    [1]=>
    array(5) {
      ["line"]=>
      int(1)
      ["col"]=>
      int(11)
      ["message"]=>
      string(42) "cannot continue because of previous errors"
      ["messageid"]=>
      string(3) "154"
      ["explanation"]=>
      string(228) "<p class="helpwanted">
      <a
        href="feedback.html?uri=http%3A%2F%2Fwww.nasa.gov%2F;errmsg_id=154#errormsg"
	title="Suggest improvements on this error message through our feedback channels" 
      >&#x2709;</a>
    </p>"
    }
  }
  ["warnings"]=>
  array(1) {
    [0]=>
    array(2) {
      ["messageid"]=>
      string(3) "W06"
      ["message"]=>
      string(31) "Unable to Determine Parse Mode!"
    }
  }
  ["warn_num"]=>
  int(1)
}

</xmp></pre><hr />
<h2>Output of the Curl request</h2>
Return the full xml text from the soap server, here split first of 200th caracther<br/>
$output = $check-><strong>get_curl_output(</strong><strong>)</strong>;<br />
var_dump(substr($output, 0, 200));<br />
<pre><xmp>string(200) "<?xml version="1.0" encoding="UTF-8"?>
<env:Envelope xmlns:env="http://www.w3.org/2003/05/soap-envelope">
<env:Body>
<m:markupvalidationresponse env:encodingStyle="http://www.w3.org/2003/05/soap-encod"
</xmp></pre></p>

<p>
<h1>fast_validate Method</h1>

   <span class="type">array()</span> <span class="methodname"><b>fast_validate</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter"><i>$url</i></tt></span>
   )</br>
<p>
Use an HEAD http request to the server, parse the returned headers and store it in an array
</p>

   <hr />
$url = 'http://www.governo.it/Presidenza/index.html';<br />
$result = $check-><strong>fast_validate(</strong><i>$url</i><strong>)</strong>;<br />
var_dump($result);<br />

<pre><xmp>array(3) {
  ["status"]=>
  string(5) "valid"
  ["err_num"]=>
  int(0)
  ["warn_num"]=>
  int(0)
}
</xmp></pre><hr />
$url = 'http://www.nasa.gov/';<br />

$result = $check-><strong>fast_validate(</strong><i>$url</i><strong>)</strong>;<br />
var_dump($result);<br />

<pre><xmp>array(3) {
  ["status"]=>
  string(7) "invalid"
  ["err_num"]=>
  int(2)
  ["warn_num"]=>
  int(1)
}
</xmp></pre><hr />
<h2>Output of the Curl request</h2>
$output = $check-><strong>get_curl_output(</strong><strong>)</strong>;<br />

var_dump($output);<br />
<pre><xmp>string(333) "HTTP/1.1 200 OK
Date: Sun, 11 Sep 2011 20:16:36 GMT
Server: Apache/2.2.9 (Debian) mod_python/3.3.1 Python/2.5.2
X-W3C-Validator-Recursion: 1
X-W3C-Validator-Status: Invalid
X-W3C-Validator-Errors: 2
X-W3C-Validator-Warnings: 1
Content-Type: application/soap+xml; charset=UTF-8
Via: 1.1 validator.w3.org
Connection: close

"
</xmp></pre></p>

<p>
<h1>isValid Method</h1>
   <span class="type">array()</span> <span class="methodname"><b>isValid</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter"><i>$url</i></tt></span>

   )</br>
<p>
Use an HEAD http request to the server, parse the returned headers and return true or false
</p>
   <hr />
$url_1 = 'http://www.nasa.gov/';<br />
$url_2 = 'http://www.governo.it/Presidenza/index.html';<br />
$result_1 = $check->isValid($url_1);<br />
$result_2 = $check->isValid($url_2);<br />
var_dump($result_1);<br />

var_dump($result_2);<br />
<pre><xmp>bool(false)
</xmp></pre><pre><xmp>bool(true)
</xmp></pre>

</p>
</body>
</html>